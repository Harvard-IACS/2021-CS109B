<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8"/>
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
            name="description"
            content="Spring 2021 - Harvard University, Institute for Applied Computational Science. Lecture 27: τ AE the Bayesian Approach"
    />
    <meta name="author" content="Pavlos Protopapas"/>
    <meta
            name="keywords"
            content="seq2seq, attention"
    />

    <!-- Bootstrap CSS -->
    <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
            integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
            crossorigin="anonymous"
    />

    <link
            rel="stylesheet"
            href="https://use.fontawesome.com/releases/v5.2.0/css/all.css"
            integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
            crossorigin="anonymous"
    />

    <link
            href="https://fonts.googleapis.com/css?family=Roboto+Condensed|Roboto:300,400,700"
            rel="stylesheet"
    />

    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css"
    />

    <link
            rel="stylesheet"
            href="../../../style/tipuesearch/tipuesearch.css"
    />

    <link
            rel="shortcut icon"
            type="image/x-icon"
            href="../../../style/images/favicon.ico"
    />
    <link rel="stylesheet" href="../../../style/css/iacs.css"/>

    <title>Harvard CS109B | Lecture 27: τ AE the Bayesian Approach</title>

    <style>
        .navbar {
            background-color: #c90016
        }
    </style>
</head>
<body>
<nav class="navbar navbar-dark navbar-expand-md">
    <div class="container">
        <a class="navbar-brand" href="../../..">
            <img
                    class="navbar-brand-logo"
                    src="../../../style/images/logo.png"
            />
            <h3 class="course-title">CS109B</h3>
        </a>
        <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarsDefault"
                aria-controls="navbarsDefault"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarsDefault">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/syllabus.html">Syllabus</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/calendar.html">Calendar</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/schedule.html">Schedule</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/materials.html">Materials</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/faq.html">FAQ</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/preparation.html">Preparing for this course</a>
                </li>
                <form
                        class="form-inline my-2"
                        action="../../../search.html"
                        onsubmit="return validateForm(this.elements['q'].value);"
                >
                    <div class="input-group input-group-sm">
                        <input
                                class="form-control"
                                type="text"
                                name="q"
                                placeholder="Search Topic"
                        />
                        <div class="input-group-append">
                            <button class="btn btn-default" type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </form>
            </ul>
        </div>
        <!-- .collapse navbar-collapse -->
    </div>
    <!-- .container -->
</nav>
<main id="content" class="container">
    <div>
        <div class="float-left">
            <p>
                Key Word(s): <a href="../../../pages/materials.html#seq2seq"
            >seq2seq</a
            >, <a href="../../../pages/materials.html#attention"
            >attention</a
            ></p>
        </div>
        <div class="float-right">
            <a href="../../../lectures/lecture27/notebook/mcmc_neural_network_scaffold.ipynb">
                Download Notebook <i class="fas fa-download"></i>
            </a>
        </div>
    </div>
    <br/>
    <hr/>
    <style type="text/css">/*!
*
* IPython notebook
*
*/
    /* CSS font colors for translated ANSI escape sequences */
    /* The color values are a mix of
       http://www.xcolors.net/dl/baskerville-ivorylight and
       http://www.xcolors.net/dl/euphrasia */
    .ansi-black-fg {
        color: #3E424D;
    }

    .ansi-black-bg {
        background-color: #3E424D;
    }

    .ansi-black-intense-fg {
        color: #282C36;
    }

    .ansi-black-intense-bg {
        background-color: #282C36;
    }

    .ansi-red-fg {
        color: #E75C58;
    }

    .ansi-red-bg {
        background-color: #E75C58;
    }

    .ansi-red-intense-fg {
        color: #B22B31;
    }

    .ansi-red-intense-bg {
        background-color: #B22B31;
    }

    .ansi-green-fg {
        color: #00A250;
    }

    .ansi-green-bg {
        background-color: #00A250;
    }

    .ansi-green-intense-fg {
        color: #007427;
    }

    .ansi-green-intense-bg {
        background-color: #007427;
    }

    .ansi-yellow-fg {
        color: #DDB62B;
    }

    .ansi-yellow-bg {
        background-color: #DDB62B;
    }

    .ansi-yellow-intense-fg {
        color: #B27D12;
    }

    .ansi-yellow-intense-bg {
        background-color: #B27D12;
    }

    .ansi-blue-fg {
        color: #208FFB;
    }

    .ansi-blue-bg {
        background-color: #208FFB;
    }

    .ansi-blue-intense-fg {
        color: #0065CA;
    }

    .ansi-blue-intense-bg {
        background-color: #0065CA;
    }

    .ansi-magenta-fg {
        color: #D160C4;
    }

    .ansi-magenta-bg {
        background-color: #D160C4;
    }

    .ansi-magenta-intense-fg {
        color: #A03196;
    }

    .ansi-magenta-intense-bg {
        background-color: #A03196;
    }

    .ansi-cyan-fg {
        color: #60C6C8;
    }

    .ansi-cyan-bg {
        background-color: #60C6C8;
    }

    .ansi-cyan-intense-fg {
        color: #258F8F;
    }

    .ansi-cyan-intense-bg {
        background-color: #258F8F;
    }

    .ansi-white-fg {
        color: #C5C1B4;
    }

    .ansi-white-bg {
        background-color: #C5C1B4;
    }

    .ansi-white-intense-fg {
        color: #A1A6B2;
    }

    .ansi-white-intense-bg {
        background-color: #A1A6B2;
    }

    .ansi-default-inverse-fg {
        color: #FFFFFF;
    }

    .ansi-default-inverse-bg {
        background-color: #000000;
    }

    .ansi-bold {
        font-weight: bold;
    }

    .ansi-underline {
        text-decoration: underline;
    }

    /* The following styles are deprecated an will be removed in a future version */
    .ansibold {
        font-weight: bold;
    }

    .ansi-inverse {
        outline: 0.5px dotted;
    }

    /* use dark versions for foreground, to improve visibility */
    .ansiblack {
        color: black;
    }

    .ansired {
        color: darkred;
    }

    .ansigreen {
        color: darkgreen;
    }

    .ansiyellow {
        color: #c4a000;
    }

    .ansiblue {
        color: darkblue;
    }

    .ansipurple {
        color: darkviolet;
    }

    .ansicyan {
        color: steelblue;
    }

    .ansigray {
        color: gray;
    }

    /* and light for background, for the same reason */
    .ansibgblack {
        background-color: black;
    }

    .ansibgred {
        background-color: red;
    }

    .ansibggreen {
        background-color: green;
    }

    .ansibgyellow {
        background-color: yellow;
    }

    .ansibgblue {
        background-color: blue;
    }

    .ansibgpurple {
        background-color: magenta;
    }

    .ansibgcyan {
        background-color: cyan;
    }

    .ansibggray {
        background-color: gray;
    }

    div.cell {
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: vertical;
        -moz-box-align: stretch;
        display: box;
        box-orient: vertical;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: column;
        align-items: stretch;
        border-radius: 2px;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        border-width: 1px;
        border-style: solid;
        border-color: transparent;
        width: 100%;
        padding: 5px;
        /* This acts as a spacer between cells, that is outside the border */
        margin: 0px;
        outline: none;
        position: relative;
        overflow: visible;
    }

    div.cell:before {
        position: absolute;
        display: block;
        top: -1px;
        left: -1px;
        width: 5px;
        height: calc(100% + 2px);
        content: '';
        background: transparent;
    }

    div.cell.jupyter-soft-selected {
        border-left-color: #E3F2FD;
        border-left-width: 1px;
        padding-left: 5px;
        border-right-color: #E3F2FD;
        border-right-width: 1px;
        background: #E3F2FD;
    }

    @media print {
        div.cell.jupyter-soft-selected {
            border-color: transparent;
        }
    }

    div.cell.selected,
    div.cell.selected.jupyter-soft-selected {
        border-color: #ababab;
    }

    div.cell.selected:before,
    div.cell.selected.jupyter-soft-selected:before {
        position: absolute;
        display: block;
        top: -1px;
        left: -1px;
        width: 5px;
        height: calc(100% + 2px);
        content: '';
        background: #42A5F5;
    }

    @media print {
        div.cell.selected,
        div.cell.selected.jupyter-soft-selected {
            border-color: transparent;
        }
    }

    .edit_mode div.cell.selected {
        border-color: #66BB6A;
    }

    .edit_mode div.cell.selected:before {
        position: absolute;
        display: block;
        top: -1px;
        left: -1px;
        width: 5px;
        height: calc(100% + 2px);
        content: '';
        background: #66BB6A;
    }

    @media print {
        .edit_mode div.cell.selected {
            border-color: transparent;
        }
    }

    .prompt {
        /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
        min-width: 14ex;
        /* This padding is tuned to match the padding on the CodeMirror editor. */
        padding: 0.4em;
        margin: 0px;
        font-family: monospace;
        text-align: right;
        /* This has to match that of the the CodeMirror class line-height below */
        line-height: 1.21429em;
        /* Don't highlight prompt number selection */
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        /* Use default cursor */
        cursor: default;
    }

    @media (max-width: 540px) {
        .prompt {
            text-align: left;
        }
    }

    div.inner_cell {
        min-width: 0;
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: vertical;
        -moz-box-align: stretch;
        display: box;
        box-orient: vertical;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: column;
        align-items: stretch;
        /* Old browsers */
        -webkit-box-flex: 1;
        -moz-box-flex: 1;
        box-flex: 1;
        /* Modern browsers */
        flex: 1;
    }

    /* input_area and input_prompt must match in top border and margin for alignment */
    div.input_area {
        border: 1px solid #cfcfcf;
        border-radius: 2px;
        background: #f7f7f7;
        line-height: 1.21429em;
    }

    /* This is needed so that empty prompt areas can collapse to zero height when there
       is no content in the output_subarea and the prompt. The main purpose of this is
       to make sure that empty JavaScript output_subareas have no height. */
    div.prompt:empty {
        padding-top: 0;
        padding-bottom: 0;
    }

    div.unrecognized_cell {
        padding: 5px 5px 5px 0px;
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: horizontal;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: horizontal;
        -moz-box-align: stretch;
        display: box;
        box-orient: horizontal;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: row;
        align-items: stretch;
    }

    div.unrecognized_cell .inner_cell {
        border-radius: 2px;
        padding: 5px;
        font-weight: bold;
        color: red;
        border: 1px solid #cfcfcf;
        background: #eaeaea;
    }

    div.unrecognized_cell .inner_cell a {
        color: inherit;
        text-decoration: none;
    }

    div.unrecognized_cell .inner_cell a:hover {
        color: inherit;
        text-decoration: none;
    }

    @media (max-width: 540px) {
        div.unrecognized_cell > div.prompt {
            display: none;
        }
    }

    div.code_cell {
        /* avoid page breaking on code cells when printing */
    }

    @media print {
        div.code_cell {
            page-break-inside: avoid;
        }
    }

    /* any special styling for code cells that are currently running goes here */
    div.input {
        page-break-inside: avoid;
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: horizontal;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: horizontal;
        -moz-box-align: stretch;
        display: box;
        box-orient: horizontal;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: row;
        align-items: stretch;
    }

    @media (max-width: 540px) {
        div.input {
            /* Old browsers */
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-box-align: stretch;
            display: -moz-box;
            -moz-box-orient: vertical;
            -moz-box-align: stretch;
            display: box;
            box-orient: vertical;
            box-align: stretch;
            /* Modern browsers */
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }
    }

    /* input_area and input_prompt must match in top border and margin for alignment */
    div.input_prompt {
        color: #303F9F;
        border-top: 1px solid transparent;
    }

    div.input_area > div.highlight {
        margin: 0.4em;
        border: none;
        padding: 0px;
        background-color: transparent;
    }

    div.input_area > div.highlight > pre {
        margin: 0px;
        border: none;
        padding: 0px;
        background-color: transparent;
    }

    /* The following gets added to the <head> if it is detected that the user has a
     * monospace font with inconsistent normal/bold/italic height.  See
     * notebookmain.js.  Such fonts will have keywords vertically offset with
     * respect to the rest of the text.  The user should select a better font.
     * See: https://github.com/ipython/ipython/issues/1503
     *
     * .CodeMirror span {
     *      vertical-align: bottom;
     * }
     */
    .CodeMirror {
        line-height: 1.21429em;
        /* Changed from 1em to our global default */
        font-size: 14px;
        height: auto;
        /* Changed to auto to autogrow */
        background: none;
        /* Changed from white to allow our bg to show through */
    }

    .CodeMirror-scroll {
        /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
        /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
        overflow-y: hidden;
        overflow-x: auto;
    }

    .CodeMirror-lines {
        /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
        /* we have set a different line-height and want this to scale with that. */
        /* Note that this should set vertical padding only, since CodeMirror assumes
             that horizontal padding will be set on CodeMirror pre */
        padding: 0.4em 0;
    }

    .CodeMirror-linenumber {
        padding: 0 8px 0 4px;
    }

    .CodeMirror-gutters {
        border-bottom-left-radius: 2px;
        border-top-left-radius: 2px;
    }

    .CodeMirror pre {
        /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
          use .CodeMirror-lines for vertical */
        padding: 0 0.4em;
        border: 0;
        border-radius: 0;
    }

    .CodeMirror-cursor {
        border-left: 1.4px solid black;
    }

    @media screen and (min-width: 2138px) and (max-width: 4319px) {
        .CodeMirror-cursor {
            border-left: 2px solid black;
        }
    }

    @media screen and (min-width: 4320px) {
        .CodeMirror-cursor {
            border-left: 4px solid black;
        }
    }

    /*

    Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
    Adapted from GitHub theme

    */
    .highlight-base {
        color: #000;
    }

    .highlight-variable {
        color: #000;
    }

    .highlight-variable-2 {
        color: #1a1a1a;
    }

    .highlight-variable-3 {
        color: #333333;
    }

    .highlight-string {
        color: #BA2121;
    }

    .highlight-comment {
        color: #408080;
        font-style: italic;
    }

    .highlight-number {
        color: #080;
    }

    .highlight-atom {
        color: #88F;
    }

    .highlight-keyword {
        color: #008000;
        font-weight: bold;
    }

    .highlight-builtin {
        color: #008000;
    }

    .highlight-error {
        color: #f00;
    }

    .highlight-operator {
        color: #AA22FF;
        font-weight: bold;
    }

    .highlight-meta {
        color: #AA22FF;
    }

    /* previously not defined, copying from default codemirror */
    .highlight-def {
        color: #00f;
    }

    .highlight-string-2 {
        color: #f50;
    }

    .highlight-qualifier {
        color: #555;
    }

    .highlight-bracket {
        color: #997;
    }

    .highlight-tag {
        color: #170;
    }

    .highlight-attribute {
        color: #00c;
    }

    .highlight-header {
        color: blue;
    }

    .highlight-quote {
        color: #090;
    }

    .highlight-link {
        color: #00c;
    }

    /* apply the same style to codemirror */
    .cm-s-ipython span.cm-keyword {
        color: #008000;
        font-weight: bold;
    }

    .cm-s-ipython span.cm-atom {
        color: #88F;
    }

    .cm-s-ipython span.cm-number {
        color: #080;
    }

    .cm-s-ipython span.cm-def {
        color: #00f;
    }

    .cm-s-ipython span.cm-variable {
        color: #000;
    }

    .cm-s-ipython span.cm-operator {
        color: #AA22FF;
        font-weight: bold;
    }

    .cm-s-ipython span.cm-variable-2 {
        color: #1a1a1a;
    }

    .cm-s-ipython span.cm-variable-3 {
        color: #333333;
    }

    .cm-s-ipython span.cm-comment {
        color: #408080;
        font-style: italic;
    }

    .cm-s-ipython span.cm-string {
        color: #BA2121;
    }

    .cm-s-ipython span.cm-string-2 {
        color: #f50;
    }

    .cm-s-ipython span.cm-meta {
        color: #AA22FF;
    }

    .cm-s-ipython span.cm-qualifier {
        color: #555;
    }

    .cm-s-ipython span.cm-builtin {
        color: #008000;
    }

    .cm-s-ipython span.cm-bracket {
        color: #997;
    }

    .cm-s-ipython span.cm-tag {
        color: #170;
    }

    .cm-s-ipython span.cm-attribute {
        color: #00c;
    }

    .cm-s-ipython span.cm-header {
        color: blue;
    }

    .cm-s-ipython span.cm-quote {
        color: #090;
    }

    .cm-s-ipython span.cm-link {
        color: #00c;
    }

    .cm-s-ipython span.cm-error {
        color: #f00;
    }

    .cm-s-ipython span.cm-tab {
        background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
        background-position: right;
        background-repeat: no-repeat;
    }

    div.output_wrapper {
        /* this position must be relative to enable descendents to be absolute within it */
        position: relative;
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: vertical;
        -moz-box-align: stretch;
        display: box;
        box-orient: vertical;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: column;
        align-items: stretch;
        z-index: 1;
    }

    /* class for the output area when it should be height-limited */
    div.output_scroll {
        /* ideally, this would be max-height, but FF barfs all over that */
        height: 24em;
        /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
        width: 100%;
        overflow: auto;
        border-radius: 2px;
        -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
        box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
        display: block;
    }

    /* output div while it is collapsed */
    div.output_collapsed {
        margin: 0px;
        padding: 0px;
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: vertical;
        -moz-box-align: stretch;
        display: box;
        box-orient: vertical;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: column;
        align-items: stretch;
    }

    div.out_prompt_overlay {
        height: 100%;
        padding: 0px 0.4em;
        position: absolute;
        border-radius: 2px;
    }

    div.out_prompt_overlay:hover {
        /* use inner shadow to get border that is computed the same on WebKit/FF */
        -webkit-box-shadow: inset 0 0 1px #000;
        box-shadow: inset 0 0 1px #000;
        background: rgba(240, 240, 240, 0.5);
    }

    div.output_prompt {
        color: #D84315;
    }

    /* This class is the outer container of all output sections. */
    div.output_area {
        padding: 0px;
        page-break-inside: avoid;
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: horizontal;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: horizontal;
        -moz-box-align: stretch;
        display: box;
        box-orient: horizontal;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: row;
        align-items: stretch;
    }

    div.output_area .MathJax_Display {
        text-align: left !important;
    }

    div.output_area
    div.output_area
    div.output_area img,
    div.output_area svg {
        max-width: 100%;
        height: auto;
    }

    div.output_area img.unconfined,
    div.output_area svg.unconfined {
        max-width: none;
    }

    div.output_area .mglyph > img {
        max-width: none;
    }

    /* This is needed to protect the pre formating from global settings such
       as that of bootstrap */
    .output {
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: vertical;
        -moz-box-align: stretch;
        display: box;
        box-orient: vertical;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: column;
        align-items: stretch;
    }

    @media (max-width: 540px) {
        div.output_area {
            /* Old browsers */
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-box-align: stretch;
            display: -moz-box;
            -moz-box-orient: vertical;
            -moz-box-align: stretch;
            display: box;
            box-orient: vertical;
            box-align: stretch;
            /* Modern browsers */
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }
    }

    div.output_area pre {
        margin: 0;
        padding: 1px 0 1px 0;
        border: 0;
        vertical-align: baseline;
        color: black;
        background-color: transparent;
        border-radius: 0;
    }

    /* This class is for the output subarea inside the output_area and after
       the prompt div. */
    div.output_subarea {
        overflow-x: auto;
        padding: 0.4em;
        /* Old browsers */
        -webkit-box-flex: 1;
        -moz-box-flex: 1;
        box-flex: 1;
        /* Modern browsers */
        flex: 1;
        max-width: calc(100% - 14ex);
    }

    div.output_scroll div.output_subarea {
        overflow-x: visible;
    }

    /* The rest of the output_* classes are for special styling of the different
       output types */
    /* all text output has this class: */
    div.output_text {
        text-align: left;
        color: #000;
        /* This has to match that of the the CodeMirror class line-height below */
        line-height: 1.21429em;
    }

    /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
    div.output_stderr {
        background: #fdd;
        /* very light red background for stderr */
    }

    div.output_latex {
        text-align: left;
    }

    /* Empty output_javascript divs should have no height */
    div.output_javascript:empty {
        padding: 0;
    }

    .js-error {
        color: darkred;
    }

    /* raw_input styles */
    div.raw_input_container {
        line-height: 1.21429em;
        padding-top: 5px;
    }

    pre.raw_input_prompt {
        /* nothing needed here. */
    }

    input.raw_input {
        font-family: monospace;
        font-size: inherit;
        color: inherit;
        width: auto;
        /* make sure input baseline aligns with prompt */
        vertical-align: baseline;
        /* padding + margin = 0.5em between prompt and cursor */
        padding: 0em 0.25em;
        margin: 0em 0.25em;
    }

    input.raw_input:focus {
        box-shadow: none;
    }

    p.p-space {
        margin-bottom: 10px;
    }

    div.output_unrecognized {
        padding: 5px;
        font-weight: bold;
        color: red;
    }

    div.output_unrecognized a {
        color: inherit;
        text-decoration: none;
    }

    div.output_unrecognized a:hover {
        color: inherit;
        text-decoration: none;
    }

    .rendered_html {
        color: #000;
        /* any extras will just be numbers: */
    }


    .rendered_html :link {
        text-decoration: underline;
    }

    .rendered_html :visited {
        text-decoration: underline;
    }


    .rendered_html h1:first-child {
        margin-top: 0.538em;
    }

    .rendered_html h2:first-child {
        margin-top: 0.636em;
    }

    .rendered_html h3:first-child {
        margin-top: 0.777em;
    }

    .rendered_html h4:first-child {
        margin-top: 1em;
    }

    .rendered_html h5:first-child {
        margin-top: 1em;
    }

    .rendered_html h6:first-child {
        margin-top: 1em;
    }

    .rendered_html ul:not(.list-inline),
    .rendered_html ol:not(.list-inline) {
        padding-left: 2em;
    }


    .rendered_html * + ul {
        margin-top: 1em;
    }

    .rendered_html * + ol {
        margin-top: 1em;
    }


    .rendered_html pre,
    .rendered_html tr,
    .rendered_html th,
    .rendered_html tbody tr:nth-child(odd) {
        background: #f5f5f5;
    }

    .rendered_html tbody tr:hover {
        background: rgba(66, 165, 245, 0.2);
    }

    .rendered_html * + table {
        margin-top: 1em;
    }

    .rendered_html * + p {
        margin-top: 1em;
    }

    .rendered_html * + img {
        margin-top: 1em;
    }

    .rendered_html img,
    .rendered_html img.unconfined,
    .rendered_html * + .alert {
        margin-top: 1em;
    }

    [dir="rtl"]
    div.text_cell {
        /* Old browsers */
        display: -webkit-box;
        -webkit-box-orient: horizontal;
        -webkit-box-align: stretch;
        display: -moz-box;
        -moz-box-orient: horizontal;
        -moz-box-align: stretch;
        display: box;
        box-orient: horizontal;
        box-align: stretch;
        /* Modern browsers */
        display: flex;
        flex-direction: row;
        align-items: stretch;
    }

    @media (max-width: 540px) {
        div.text_cell > div.prompt {
            display: none;
        }
    }

    div.text_cell_render {
        /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
        outline: none;
        resize: none;
        width: inherit;
        border-style: none;
        padding: 0.5em 0.5em 0.5em 0.4em;
        color: #000;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
    }

    a.anchor-link:link {
        text-decoration: none;
        padding: 0px 20px;
        visibility: hidden;
    }

    h1:hover .anchor-link,
    h2:hover .anchor-link,
    h3:hover .anchor-link,
    h4:hover .anchor-link,
    h5:hover .anchor-link,
    h6:hover .anchor-link {
        visibility: visible;
    }

    .text_cell.rendered .input_area {
        display: none;
    }

    .text_cell.rendered
    .text_cell.rendered .rendered_html tr,
    .text_cell.rendered .rendered_html th,
    .text_cell.rendered
    .text_cell.unrendered .text_cell_render {
        display: none;
    }

    .text_cell .dropzone .input_area {
        border: 2px dashed #bababa;
        margin: -1px;
    }

    .cm-header-1,
    .cm-header-2,
    .cm-header-3,
    .cm-header-4,
    .cm-header-5,
    .cm-header-6 {
        font-weight: bold;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }

    .cm-header-1 {
        font-size: 185.7%;
    }

    .cm-header-2 {
        font-size: 157.1%;
    }

    .cm-header-3 {
        font-size: 128.6%;
    }

    .cm-header-4 {
        font-size: 110%;
    }

    .cm-header-5 {
        font-size: 100%;
        font-style: italic;
    }

    .cm-header-6 {
        font-size: 100%;
        font-style: italic;
    }
    </style>
    <style type="text/css">.highlight .hll {
        background-color: #ffffcc
    }

    .highlight {
        background: #f8f8f8;
    }

    .highlight .c {
        color: #408080;
        font-style: italic
    }

    /* Comment */
    .highlight .err {
        border: 1px solid #FF0000
    }

    /* Error */
    .highlight .k {
        color: #008000;
        font-weight: bold
    }

    /* Keyword */
    .highlight .o {
        color: #666666
    }

    /* Operator */
    .highlight .ch {
        color: #408080;
        font-style: italic
    }

    /* Comment.Hashbang */
    .highlight .cm {
        color: #408080;
        font-style: italic
    }

    /* Comment.Multiline */
    .highlight .cp {
        color: #BC7A00
    }

    /* Comment.Preproc */
    .highlight .cpf {
        color: #408080;
        font-style: italic
    }

    /* Comment.PreprocFile */
    .highlight .c1 {
        color: #408080;
        font-style: italic
    }

    /* Comment.Single */
    .highlight .cs {
        color: #408080;
        font-style: italic
    }

    /* Comment.Special */
    .highlight .gd {
        color: #A00000
    }

    /* Generic.Deleted */
    .highlight .ge {
        font-style: italic
    }

    /* Generic.Emph */
    .highlight .gr {
        color: #FF0000
    }

    /* Generic.Error */
    .highlight .gh {
        color: #000080;
        font-weight: bold
    }

    /* Generic.Heading */
    .highlight .gi {
        color: #00A000
    }

    /* Generic.Inserted */
    .highlight .go {
        color: #888888
    }

    /* Generic.Output */
    .highlight .gp {
        color: #000080;
        font-weight: bold
    }

    /* Generic.Prompt */
    .highlight .gs {
        font-weight: bold
    }

    /* Generic.Strong */
    .highlight .gu {
        color: #800080;
        font-weight: bold
    }

    /* Generic.Subheading */
    .highlight .gt {
        color: #0044DD
    }

    /* Generic.Traceback */
    .highlight .kc {
        color: #008000;
        font-weight: bold
    }

    /* Keyword.Constant */
    .highlight .kd {
        color: #008000;
        font-weight: bold
    }

    /* Keyword.Declaration */
    .highlight .kn {
        color: #008000;
        font-weight: bold
    }

    /* Keyword.Namespace */
    .highlight .kp {
        color: #008000
    }

    /* Keyword.Pseudo */
    .highlight .kr {
        color: #008000;
        font-weight: bold
    }

    /* Keyword.Reserved */
    .highlight .kt {
        color: #B00040
    }

    /* Keyword.Type */
    .highlight .m {
        color: #666666
    }

    /* Literal.Number */
    .highlight .s {
        color: #BA2121
    }

    /* Literal.String */
    .highlight .na {
        color: #7D9029
    }

    /* Name.Attribute */
    .highlight .nb {
        color: #008000
    }

    /* Name.Builtin */
    .highlight .nc {
        color: #0000FF;
        font-weight: bold
    }

    /* Name.Class */
    .highlight .no {
        color: #880000
    }

    /* Name.Constant */
    .highlight .nd {
        color: #AA22FF
    }

    /* Name.Decorator */
    .highlight .ni {
        color: #999999;
        font-weight: bold
    }

    /* Name.Entity */
    .highlight .ne {
        color: #D2413A;
        font-weight: bold
    }

    /* Name.Exception */
    .highlight .nf {
        color: #0000FF
    }

    /* Name.Function */
    .highlight .nl {
        color: #A0A000
    }

    /* Name.Label */
    .highlight .nn {
        color: #0000FF;
        font-weight: bold
    }

    /* Name.Namespace */
    .highlight .nt {
        color: #008000;
        font-weight: bold
    }

    /* Name.Tag */
    .highlight .nv {
        color: #19177C
    }

    /* Name.Variable */
    .highlight .ow {
        color: #AA22FF;
        font-weight: bold
    }

    /* Operator.Word */
    .highlight .w {
        color: #bbbbbb
    }

    /* Text.Whitespace */
    .highlight .mb {
        color: #666666
    }

    /* Literal.Number.Bin */
    .highlight .mf {
        color: #666666
    }

    /* Literal.Number.Float */
    .highlight .mh {
        color: #666666
    }

    /* Literal.Number.Hex */
    .highlight .mi {
        color: #666666
    }

    /* Literal.Number.Integer */
    .highlight .mo {
        color: #666666
    }

    /* Literal.Number.Oct */
    .highlight .sa {
        color: #BA2121
    }

    /* Literal.String.Affix */
    .highlight .sb {
        color: #BA2121
    }

    /* Literal.String.Backtick */
    .highlight .sc {
        color: #BA2121
    }

    /* Literal.String.Char */
    .highlight .dl {
        color: #BA2121
    }

    /* Literal.String.Delimiter */
    .highlight .sd {
        color: #BA2121;
        font-style: italic
    }

    /* Literal.String.Doc */
    .highlight .s2 {
        color: #BA2121
    }

    /* Literal.String.Double */
    .highlight .se {
        color: #BB6622;
        font-weight: bold
    }

    /* Literal.String.Escape */
    .highlight .sh {
        color: #BA2121
    }

    /* Literal.String.Heredoc */
    .highlight .si {
        color: #BB6688;
        font-weight: bold
    }

    /* Literal.String.Interpol */
    .highlight .sx {
        color: #008000
    }

    /* Literal.String.Other */
    .highlight .sr {
        color: #BB6688
    }

    /* Literal.String.Regex */
    .highlight .s1 {
        color: #BA2121
    }

    /* Literal.String.Single */
    .highlight .ss {
        color: #19177C
    }

    /* Literal.String.Symbol */
    .highlight .bp {
        color: #008000
    }

    /* Name.Builtin.Pseudo */
    .highlight .fm {
        color: #0000FF
    }

    /* Name.Function.Magic */
    .highlight .vc {
        color: #19177C
    }

    /* Name.Variable.Class */
    .highlight .vg {
        color: #19177C
    }

    /* Name.Variable.Global */
    .highlight .vi {
        color: #19177C
    }

    /* Name.Variable.Instance */
    .highlight .vm {
        color: #19177C
    }

    /* Name.Variable.Magic */
    .highlight .il {
        color: #666666
    }

    /* Literal.Number.Integer.Long */</style>
    <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
                <h2 id="Title">Title<a class="anchor-link" href="#Title">¶</a></h2>
                <p>MCMC from Scratch for Neural Networks</p>
                <h2 id="Description-:">Description :<a class="anchor-link" href="#Description-:">¶</a></h2>
                <p>The aim of this exercise is to perform Monte Carlo Markov Chain (MCMC) from scratch for a simple
                    neural network.</p>
                <p>On completing the exercise you should be able to see a distribution similar to the following. One for
                    each network parameter:</p>
                <p><img src="../fig/fig2.png" style="width: 500px;"/></p>
                <h2 id="Instructions:">Instructions:<a class="anchor-link" href="#Instructions:">¶</a></h2>
                <ul>
                    <li>Read the data file backprop.csv and set the predictor and response variables.</li>
                    <li>Create 3 lists to store the weights and bias (i.e. the network parameters) and initialize the
                        parameter values.
                    </li>
                    <li>Define a function <code>get_log_prior</code> to compute the prior value given the network
                        parameter values.
                    </li>
                    <li>Compute the likelihood, prior and posterior for the initial parameter values.</li>
                    <li>For a selected number of sampling "epochs":
                        <ul>
                            <li>Compute new weights and bias.</li>
                            <li>Compute the corresponding likelihood, prior and posterior.</li>
                            <li>Compute the exponential ratio of the current and previous posterior.</li>
                            <li>Based on the ratio, select or reject the new parameter values.</li>
                        </ul>
                    </li>
                    <li>Choose a burn rate.</li>
                    <li>Plot the histogram of the weights and bias.</li>
                </ul>
                <h2 id="Hints:">Hints:<a class="anchor-link" href="#Hints:">¶</a></h2>
                <p><a href="https://numpy.org/doc/stable/reference/generated/numpy.log.html"
                      target="_blank">np.log()</a> Computes the natural logarithm, element-wise.</p>
                <p><a href="https://numpy.org/doc/stable/reference/generated/numpy.exp.html?highlight=exp#numpy.exp"
                      target="_blank">np.exp()</a> Calculates the exponential of all elements in the input array.</p>
                <p><a href="https://www.tensorflow.org/api_docs/python/tf/reshape" target="_blank">tf.reshape()</a>
                    Reshapes a tensor.</p>
                <p>
                    <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html?highlight=linear%20regression#sklearn.linear_model.LinearRegression.fit"
                       target="_blank">.fit()</a> Fits the linear model to the data.</p>
                <p>
                    <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html?highlight=random%20normal#numpy.random.normal"
                       target="_blank">np.random.normal()</a> Draw random samples from a normal (Gaussian) distribution.
                </p>
                <p><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html" target="_blank">norm.pdf()</a>
                    A normal continuous random variable.</p>
                <p><a href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html?highlight=sum"
                      target="_blank">np.sum()</a> Sum of array elements over a given axis.</p>
                <p>
                    <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html?highlight=random%20uniform"
                       target="_blank">np.random.uniform()</a> Draw samples from a uniform distribution.</p>
                <p><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html" target="_blank">np.zeros()</a>
                    Return a new array of given shape and type, filled with zeros.</p>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span
                            class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span
                                class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span
                                class="n">norm</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">sample</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span
                                class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">dtype</span> <span class="o">=</span> <span class="s1">'float32'</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Read the data file "backprop.csv"</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span
                                class="p">(</span><span class="s2">"backprop.csv"</span><span class="p">)</span>

<span class="c1"># Take a quick look at the data</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Get the predictor and response data</span>
<span class="n">X_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span
                                class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span
                                class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Helper code to visualize the data </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span
                                class="o">=</span><span class="p">(</span><span class="mi">4</span><span
                                class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_data</span><span
                                class="p">,</span> <span class="n">y_data</span><span class="p">,</span><span class="n">color</span><span
                                class="o">=</span><span class="s1">'g'</span> <span class="p">,</span><span
                                class="n">s</span> <span class="o">=</span> <span class="mi">20</span><span
                                class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span
                                class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span
                                class="o">=</span><span class="s1">'sample data'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X'</span><span
                                class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span
                                class="mi">14</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Y'</span><span
                                class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span
                                class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span
                                class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span
                                class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span
                                class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span
                                class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span
                                class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span
                                class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span
                                class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Convert the predictor and response variables to tensor data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">convert_to_tensor</span><span
                                class="p">(</span><span class="n">X_data</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span
                                class="p">(</span><span class="n">x</span><span class="p">,(</span><span
                                class="o">-</span><span class="mi">1</span><span class="p">,</span><span
                                class="mi">1</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">convert_to_tensor</span><span
                                class="p">(</span><span class="n">y_data</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span
                                class="p">(</span><span class="n">y</span><span class="p">,</span> <span
                                class="p">(</span><span class="o">-</span><span class="mi">1</span><span
                                class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Function to define the neural network model</span>
<span class="c1"># The network has 2 hidden nodes and one output node</span>
<span class="c1"># We use sin activation for this exercise</span>
<span class="c1"># The network has a total of 5 parameters - 4 weights and one bias for the output</span>

<span class="k">def</span> <span class="nf">basic_nn</span><span class="p">(</span><span class="n">w0</span><span
                                class="p">,</span><span class="n">w1</span><span class="p">,</span><span
                                class="n">b1</span><span class="p">,</span><span class="n">x</span><span
                                class="o">=</span><span class="n">x</span><span class="p">):</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span
                                class="p">(</span><span class="n">x</span><span class="p">,</span><span
                                class="n">w0</span><span class="p">)</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span
                                class="o">.</span><span class="n">sin</span><span class="p">(</span><span
                                class="n">h1</span><span class="p">)</span>
    <span class="n">h2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span
                                class="p">(</span><span class="n">a1</span><span class="p">,</span><span
                                class="n">w1</span><span class="p">)</span> <span class="o">+</span> <span
                                class="n">b1</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span
                                class="o">.</span><span class="n">sin</span><span class="p">(</span><span
                                class="n">h2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define 3 empty lists to store the accepted network parameters</span>

<span class="c1"># The weights0_list will contain 2 weights that connects the input</span>
<span class="c1"># to the hidden layer</span>
<span class="n">weights0_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># The weights1_list will contain 2 weights that connects the hidden</span>
<span class="c1"># nodes to the output</span>
<span class="n">weights1_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># The bias_list will hold the bias added to the output of the hidden nodes</span>
<span class="n">bias_list</span> <span class="o">=</span> <span class="p">[]</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Initialize the input to hidden weights randomly from a normal distribution </span>
<span class="c1"># with mean=(1,1) and standard deviation=(1,1)</span>
<span class="c1"># Reshape the values to shape (1,2)</span>
<span class="n">weights0</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span
                                class="n">reshape</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span
                                class="p">(</span><span class="n">loc</span><span class="o">=</span><span
                                class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span
                                class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">scale</span><span
                                class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span
                                class="p">,</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">size</span><span
                                class="o">=</span><span class="p">(</span><span class="mi">1</span><span
                                class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">shape</span><span
                                class="o">=</span><span class="p">(</span><span class="mi">1</span><span
                                class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Initialize the hidden to output weights randomly from a normal distribution </span>
<span class="c1"># with mean=(-0.4,12) and standard deviation=(0.1,0.1)</span>
<span class="c1"># Reshape the values to shape (2,1)</span>
<span class="n">weights1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span
                                class="n">reshape</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span
                                class="p">(</span><span class="n">loc</span><span class="o">=</span><span
                                class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span
                                class="mi">0</span><span class="p">),</span><span class="n">scale</span><span class="o">=</span><span
                                class="p">(</span><span class="mf">0.1</span><span class="p">)),</span> <span class="n">shape</span><span
                                class="o">=</span><span class="p">(</span><span class="mi">2</span><span
                                class="p">,</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Initialize the bias randomly from a normal distribution </span>
<span class="c1"># with mean=1 and standard deviation=1</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span
                                class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span
                                class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">scale</span><span
                                class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Function to get the prior given the network parameters</span>
<span class="c1"># NOTE - All the computations are done in the log space so </span>
<span class="c1"># that the numbers are managable.</span>

<span class="k">def</span> <span class="nf">get_log_prior</span><span class="p">(</span><span
                                class="n">weights0</span><span class="p">,</span><span class="n">weights1</span><span
                                class="p">,</span> <span class="n">bias</span><span class="p">):</span>

    <span class="c1"># Initialize a numpy array of zeros with shape 2,1</span>
    <span class="n">prior_w0</span> <span class="o">=</span> <span class="n">___</span>
    
    <span class="c1"># Find the probability of the first weight given the normal PDF with mean =1 and std=1</span>
    <span class="c1"># Take the log of this value</span>
    <span class="n">prior_w0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span
                                class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                class="n">log</span><span class="p">(</span><span class="n">norm</span><span
                                class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">weights0</span><span
                                class="p">[</span><span class="mi">0</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">],</span><span class="o">-</span><span
                                class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span
                                class="p">))</span>
    
    <span class="c1"># Find the probability of the second weight given the normal PDF with mean =1 and std=1</span>
    <span class="c1"># Take the log of this value</span>
    <span class="n">prior_w0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span
                                class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                class="n">log</span><span class="p">(</span><span class="n">___</span><span
                                class="p">)</span>

    <span class="c1"># Initialize a numpy array of zeros with shape 2,1</span>
    <span class="n">prior_w1</span> <span class="o">=</span> <span class="n">___</span>  
    
    <span class="c1"># Find the probability of the third weight given the normal PDF with mean =0.6 and std=0.1</span>
    <span class="c1"># Take the log of this value</span>
    <span class="n">prior_w1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span
                                class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                class="n">log</span><span class="p">(</span><span class="n">___</span><span
                                class="p">)</span>
    
    <span class="c1"># Find the probability of the first weight given the normal PDF with mean =0 and std=0.1</span>
    <span class="c1"># Take the log of this value</span>
    <span class="n">prior_w1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span
                                class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                class="n">log</span><span class="p">(</span><span class="n">___</span><span
                                class="p">)</span>

    <span class="c1"># Find the probability of the bias given the normal PDF with mean=2.5 and std=0.1</span>
    <span class="c1"># Take the log of this value</span>
    <span class="n">prior_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                class="n">log</span><span class="p">(</span><span class="n">___</span><span
                                class="p">)</span>
    
    <span class="c1"># Compute the prior as the sum of the previously computed priors</span>
    <span class="n">log_prior</span> <span class="o">=</span> <span class="n">___</span>
  
    <span class="c1"># Return the prior value</span>
    <span class="k">return</span> <span class="n">log_prior</span>
    
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Get the prior of the initial network parameters by calling the get_log_prior function</span>
<span class="n">log_prior</span> <span class="o">=</span> <span class="n">___</span>

<span class="c1"># Get the network predictions by calling the basic_nn function</span>
<span class="n">ypred</span> <span class="o">=</span> <span class="n">___</span>

<span class="c1"># Compute the -ve log likelihood  given the true y and predicted y</span>
<span class="n">log_likelihood</span> <span class="o">=</span>  <span class="o">-</span><span class="n">np</span><span
                                class="o">.</span><span class="n">sum</span><span class="p">(((</span><span
                                class="n">y</span><span class="o">-</span><span class="n">ypred</span><span
                                class="p">)</span><span class="o">**</span><span class="mi">2</span><span
                                class="p">))</span>

<span class="c1"># Compute the posterior as the sum of the likelihood and prior</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">___</span>

<span class="c1"># Save the current posterior value as prev_posterior for comparision later</span>
<span class="n">prev_posterior</span> <span class="o">=</span> <span class="n">___</span>

<span class="c1"># Append weights0 to the weights0_list</span>
<span class="n">weights0_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
                                class="n">weights0</span><span class="p">)</span>

<span class="c1"># Append weights1 to the weights1_list</span>
<span class="n">weights1_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
                                class="n">weights1</span><span class="p">)</span>

<span class="c1"># Append bias to the bias_list</span>
<span class="n">bias_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
                                class="n">bias</span><span class="p">)</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Specify the number of sampling "epochs". Set it to atleast 10000</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="n">___</span>

<span class="c1"># Loop over the range of sampling "epochs"</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span
                                class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">5000</span>==0:
        <span class="nb">print</span><span class="p">(</span><span class="s2">"EPOCH: "</span><span
                                class="p">,</span><span class="n">i</span><span class="p">)</span>

    <span class="c1"># Get the candidate input to hidden weights randomly from a normal distribution </span>
    <span class="c1"># with mean as the last element added to weights0_list and standard deviation=(0.1,0.1)</span>
    <span class="c1"># Reshape the values to shape (1,2)</span>
    <span class="n">weights0</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span
                                class="n">reshape</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span
                                class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">weights0_list</span><span
                                class="p">[</span><span class="o">-</span><span class="mi">1</span><span
                                class="p">],</span><span class="n">scale</span><span class="o">=</span><span
                                class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span
                                class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span
                                class="p">(</span><span class="mi">1</span><span class="p">,</span><span
                                class="mi">2</span><span class="p">))</span>

    <span class="c1"># Get the candidate hidden to output weights randomly from a normal distribution </span>
    <span class="c1"># with mean as the last element added to weights1_list and standard deviation=1</span>
    <span class="c1"># Reshape the values to shape (2,1)</span>
    <span class="n">weights1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span
                                class="n">reshape</span><span class="p">(</span><span class="n">___</span><span
                                class="p">,</span> <span class="n">shape</span><span class="o">=</span><span
                                class="p">(</span><span class="mi">2</span><span class="p">,</span><span
                                class="mi">1</span><span class="p">))</span>

    <span class="c1"># Get the candidate bias randomly from a normal distribution </span>
    <span class="c1"># with mean as the last element added to bias_list and standard deviation=1</span>
    <span class="n">bias</span> <span class="o">=</span> <span class="n">___</span>

    <span class="c1"># Get the prior values for the candidate values by calling the get_log_prior function</span>
    <span class="n">log_prior</span> <span class="o">=</span> <span class="n">___</span>

    <span class="c1"># Get the network predictions by calling the basic_nn function with the candidate values</span>
    <span class="n">ypred</span> <span class="o">=</span> <span class="n">___</span>

    <span class="c1"># Compute P(data|w) i.e. the log-likelihood given the true y and predicted y</span>
    <span class="n">log_likelihood</span> <span class="o">=</span> <span class="n">___</span>

    <span class="c1"># To compute the posterior given the likelihood and prior</span>
    <span class="c1"># The posterior is the sum of the likelihood and prior</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="n">___</span>

    <span class="c1"># Compute the the exponential of the ratio of the posterior given its previous value</span>
    <span class="n">exp_ratio</span> <span class="o">=</span> <span class="n">___</span>

    <span class="c1"># If the ratio is greater than or equal to 1 then accept the candidate values in this case</span>
    <span class="k">if</span> <span class="n">exp_ratio</span><span class="o">>=</span><span class="mi">1</span><span
                                class="p">:</span>

        <span class="c1"># Append the candidate values to the weights and bias list</span>
        <span class="n">weights0_list</span><span class="o">.</span><span class="n">append</span><span
                                class="p">(</span><span class="n">weights0</span><span class="p">)</span>
        <span class="n">weights1_list</span><span class="o">.</span><span class="n">append</span><span
                                class="p">(</span><span class="n">weights1</span><span class="p">)</span>
        <span class="n">bias_list</span><span class="o">.</span><span class="n">append</span><span
                                class="p">(</span><span class="n">bias</span><span class="p">)</span>

        <span class="c1"># Save the accepted posterior as the previous posterior</span>
        <span class="n">prev_posterior</span> <span class="o">=</span> <span class="n">posterior</span>

    <span class="c1"># If the ratio is less than 1 then get a random value between 0 and 1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">coin</span> <span class="o">=</span> <span class="n">___</span>

        <span class="c1"># Set a threshold value</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.98</span>
        
        <span class="c1"># Check if the random value is higher than the threshold</span>
        <span class="c1"># Append the candidate values to the list and update the previous posterior</span>
        <span class="k">if</span> <span class="n">coin</span> <span class="o">></span> <span
                                class="n">threshold</span><span class="p">:</span>
            <span class="n">weights0_list</span><span class="o">.</span><span class="n">append</span><span
                                class="p">(</span><span class="n">weights0</span><span class="p">)</span>
            <span class="n">weights1_list</span><span class="o">.</span><span class="n">append</span><span
                                class="p">(</span><span class="n">weights1</span><span class="p">)</span>
            <span class="n">bias_list</span><span class="o">.</span><span class="n">append</span><span
                                class="p">(</span><span class="n">bias</span><span class="p">)</span>
            <span class="n">prev_posterior</span> <span class="o">=</span> <span class="n">posterior</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># The number of data points to consider after the beta list has been populated</span>
<span class="n">burn_rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
                                class="nb">len</span><span class="p">(</span><span class="n">bias_list</span><span
                                class="p">)</span><span class="o">*</span><span class="mf">0.2</span><span
                                class="p">)</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Helper code to plot the distribution of network parameter</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span
                                class="o">.</span><span class="n">subplots</span><span class="p">(</span><span
                                class="mi">5</span><span class="p">,</span><span class="mi">2</span><span
                                class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span
                                class="p">(</span><span class="mi">15</span><span class="p">,</span><span
                                class="mi">15</span><span class="p">))</span>
<span class="n">col1</span> <span class="o">=</span> <span class="s2">"#B2D7D0"</span>
<span class="n">col2</span> <span class="o">=</span> <span class="s2">"#EFAEA4"</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">12</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span
                                class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span
                                class="p">):</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span
                                class="n">hist</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights0_list</span><span
                                class="p">)[:,</span><span class="mi">0</span><span class="p">,</span><span
                                class="mi">0</span><span class="p">],</span> <span class="n">color</span><span
                                class="o">=</span><span class="n">col1</span><span class="p">,</span><span class="n">linewidth</span><span
                                class="o">=</span><span class="mf">1.2</span><span class="p">,</span><span class="n">edgecolor</span><span
                                class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Weight 1"</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span
                                class="p">(</span><span class="s2">"Frequency"</span><span class="p">)</span>


  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span
                                class="n">plot</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights0_list</span><span
                                class="p">)[:,</span><span class="mi">0</span><span class="p">,</span><span
                                class="mi">0</span><span class="p">],</span> <span class="n">color</span><span
                                class="o">=</span><span class="n">col2</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Weight 1"</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span
                                class="p">(</span><span class="s2">"CHAIN"</span><span class="p">,</span> <span
                                class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span
                                class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span
                                class="n">hist</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights0_list</span><span
                                class="p">)[:,</span><span class="mi">0</span><span class="p">,</span><span
                                class="mi">1</span><span class="p">],</span> <span class="n">color</span><span
                                class="o">=</span><span class="n">col1</span><span class="p">,</span><span class="n">linewidth</span><span
                                class="o">=</span><span class="mf">1.2</span><span class="p">,</span><span class="n">edgecolor</span><span
                                class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Weight 2"</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span
                                class="p">(</span><span class="s2">"Frequency"</span><span class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span
                                class="n">plot</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights0_list</span><span
                                class="p">)[:,</span><span class="mi">0</span><span class="p">,</span><span
                                class="mi">1</span><span class="p">],</span> <span class="n">color</span><span
                                class="o">=</span><span class="n">col2</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Weight 2"</span><span class="p">)</span>


  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span
                                class="n">hist</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights1_list</span><span
                                class="p">)[:,</span><span class="mi">0</span><span class="p">,</span><span
                                class="mi">0</span><span class="p">],</span> <span class="n">color</span><span
                                class="o">=</span><span class="n">col1</span><span class="p">,</span><span class="n">linewidth</span><span
                                class="o">=</span><span class="mf">1.2</span><span class="p">,</span><span class="n">edgecolor</span><span
                                class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Weight 3"</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span
                                class="p">(</span><span class="s2">"Frequency"</span><span class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span
                                class="n">plot</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights1_list</span><span
                                class="p">)[:,</span><span class="mi">0</span><span class="p">,</span><span
                                class="mi">0</span><span class="p">],</span> <span class="n">color</span><span
                                class="o">=</span><span class="n">col2</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Weight 3"</span><span class="p">)</span>


  <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span
                                class="n">hist</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights1_list</span><span
                                class="p">)[:,</span><span class="mi">1</span><span class="p">,</span><span
                                class="mi">0</span><span class="p">],</span> <span class="n">color</span><span
                                class="o">=</span><span class="n">col1</span><span class="p">,</span><span class="n">linewidth</span><span
                                class="o">=</span><span class="mf">1.2</span><span class="p">,</span><span class="n">edgecolor</span><span
                                class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Weight 4"</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span
                                class="p">(</span><span class="s2">"Frequency"</span><span class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span
                                class="n">plot</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">weights1_list</span><span
                                class="p">)[:,</span><span class="mi">1</span><span class="p">,</span><span
                                class="mi">0</span><span class="p">],</span> <span class="n">color</span><span
                                class="o">=</span><span class="n">col2</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Weight 4"</span><span class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span
                                class="n">hist</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bias_list</span><span
                                class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">col1</span><span
                                class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span
                                class="mf">1.2</span><span class="p">,</span><span class="n">edgecolor</span><span
                                class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Bias"</span><span class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span
                                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span
                                class="p">(</span><span class="s2">"Frequency"</span><span class="p">)</span>

  <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span
                                class="n">plot</span><span class="p">(</span><span class="n">np</span><span
                                class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bias_list</span><span
                                class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">col2</span><span
                                class="p">)</span>
  <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span
                                class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span
                                class="p">(</span><span class="s2">"Bias"</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
                <h3 id="⏸-Go-back-and-change-the-mean-and-standard-deviation-of-weights1-while-intializing-to-0-and-1-respectively.-What-change-do-you-notice-in-the-result-distribution?">
                    ⏸ Go back and change the mean and standard deviation of weights1 while intializing to 0 and 1
                    respectively. What change do you notice in the result distribution?<a class="anchor-link"
                                                                                          href="#⏸-Go-back-and-change-the-mean-and-standard-deviation-of-weights1-while-intializing-to-0-and-1-respectively.-What-change-do-you-notice-in-the-result-distribution?">¶</a>
                </h3>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span
                            class="c1">### edTest(test_chow1) ###</span>
<span class="c1"># Type your answer in the space given below</span>
<span class="n">answer1</span> <span class="o">=</span> <span class="s1">'___'</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
                <h3 id="⏸-How-is-the-distribution-affected-if-mean-and-standard-deviation-of-prior_w1[0]-and-prior_w1[0]-are-set-to-0-and-1?">
                    ⏸ How is the distribution affected if mean and standard deviation of prior_w1[0] and prior_w1[0] are
                    set to 0 and 1?<a class="anchor-link"
                                      href="#⏸-How-is-the-distribution-affected-if-mean-and-standard-deviation-of-prior_w1[0]-and-prior_w1[0]-are-set-to-0-and-1?">¶</a>
                </h3>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span
                            class="c1">### edTest(test_chow2) ###</span>
<span class="c1"># Type your answer in the space given below</span>
<span class="n">answer2</span> <span class="o">=</span> <span class="s1">'___'</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing text_cell rendered">
        <div class="prompt input_prompt">
        </div>
        <div class="inner_cell">
            <div class="text_cell_render border-box-sizing rendered_html">
                <h3 id="⏸-For-each-network-parameter,-what-affect-does-increase-in-scale-of-the-prior-from-0.1-to-10-expect-to-bring-out,-given-you-start-from-a-prior-that-is-very-close-to-the-true-value?">
                    ⏸ For each network parameter, what affect does increase in scale of the prior from 0.1 to 10 expect
                    to bring out, given you start from a prior that is very close to the true value?<a
                        class="anchor-link"
                        href="#⏸-For-each-network-parameter,-what-affect-does-increase-in-scale-of-the-prior-from-0.1-to-10-expect-to-bring-out,-given-you-start-from-a-prior-that-is-very-close-to-the-true-value?">¶</a>
                </h3><h4
                    id="A.-With-a-wider-range-of-possible-values,-the-parameters-would-converge-to-the-true-values-faster.">
                A. With a wider range of possible values, the parameters would converge to the true values faster.<a
                    class="anchor-link"
                    href="#A.-With-a-wider-range-of-possible-values,-the-parameters-would-converge-to-the-true-values-faster.">¶</a>
            </h4><h4 id="B.-The-prior-is-a-constant,-and-hence-does-not-affect-the-the-parameter-convergence.">B. The
                prior is a constant, and hence does not affect the the parameter convergence.<a class="anchor-link"
                                                                                                href="#B.-The-prior-is-a-constant,-and-hence-does-not-affect-the-the-parameter-convergence.">¶</a>
            </h4><h4
                    id="C.-The-parameters-will-take-longer-to-converge-to-their-true-values-as-the-values-bounce-around-more.">
                C. The parameters will take longer to converge to their true values as the values bounce around more.<a
                    class="anchor-link"
                    href="#C.-The-parameters-will-take-longer-to-converge-to-their-true-values-as-the-values-bounce-around-more.">¶</a>
            </h4><h4
                    id="D.-The-parameter-only-depends-on-the-mean-and-previous-prior,-not-the-standard-deviation.-Hence,-there-would-be-no-affect-with-a-change-in-the-standard-devidation.">
                D. The parameter only depends on the mean and previous prior, not the standard deviation. Hence, there
                would be no affect with a change in the standard devidation.<a class="anchor-link"
                                                                               href="#D.-The-parameter-only-depends-on-the-mean-and-previous-prior,-not-the-standard-deviation.-Hence,-there-would-be-no-affect-with-a-change-in-the-standard-devidation.">¶</a>
            </h4>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span
                            class="c1">### edTest(test_chow3) ###</span>
<span class="c1"># Submit an answer choice as a string below (eg. if you choose option C, put 'C')</span>
<span class="n">answer3</span> <span class="o">=</span> <span class="s1">'___'</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cell border-box-sizing code_cell rendered">
        <div class="input">
            <div class="prompt input_prompt">In [0]:</div>
            <div class="inner_cell">
                <div class="input_area">
                    <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Helper code to visualize the prediction by taking the mean of the network parameters</span>
<span class="n">wl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span
                                class="p">(</span><span class="n">weights0_list</span><span class="p">[</span><span
                                class="n">burn_rate</span><span class="p">:])</span>
<span class="n">wl2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span
                                class="p">(</span><span class="n">weights1_list</span><span class="p">[</span><span
                                class="n">burn_rate</span><span class="p">:])</span>
<span class="n">bi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span
                                class="p">(</span><span class="n">bias_list</span><span class="p">[</span><span
                                class="n">burn_rate</span><span class="p">:])</span>

<span class="c1"># Take the mean of the model parameters</span>
<span class="n">w0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                class="n">mean</span><span class="p">(</span><span class="n">wl</span><span class="p">[:,</span><span
                                class="mi">0</span><span class="p">,:],</span> <span class="n">axis</span><span
                                class="o">=</span><span class="mi">0</span><span class="p">)</span><span
                                class="o">.</span><span class="n">reshape</span><span class="p">(</span><span
                                class="mi">1</span><span class="p">,</span><span class="mi">2</span><span
                                class="p">)</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                class="n">mean</span><span class="p">(</span><span class="n">wl2</span><span class="p">[:,:,</span><span
                                class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span
                                class="mi">0</span><span class="p">)</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span
                                class="p">(</span><span class="n">tf</span><span class="o">.</span><span
                                class="n">cast</span><span class="p">(</span><span class="n">w1</span><span
                                class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span
                                class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span
                                class="mi">2</span><span class="p">,</span><span class="mi">1</span><span
                                class="p">))</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                class="n">mean</span><span class="p">(</span><span class="n">bi</span><span
                                class="p">)</span>

<span class="c1"># Get the network prediction</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span
                                class="p">(</span><span class="n">tf</span><span class="o">.</span><span
                                class="n">cast</span><span class="p">(</span><span class="n">x</span><span
                                class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">'float32'</span><span
                                class="p">),</span> <span class="n">w0</span><span class="p">)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span
                                class="n">math</span><span class="o">.</span><span class="n">sin</span><span
                                class="p">(</span><span class="n">h1</span><span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span
                                class="p">(</span><span class="n">a1</span><span class="p">,</span><span
                                class="n">w1</span><span class="p">)</span> <span class="o">+</span> <span
                                class="n">b1</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span
                                class="o">.</span><span class="n">sin</span><span class="p">(</span><span
                                class="n">h2</span><span class="p">)</span>

<span class="c1"># Plot the true data and model prediction</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_data</span><span
                                class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span
                                class="s1">'b+'</span><span class="p">,</span> <span class="n">label</span><span
                                class="o">=</span><span class="s2">"True Data"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_data</span><span
                                class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span
                                class="s1">'ro'</span><span class="p">,</span> <span class="n">label</span> <span
                                class="o">=</span> <span class="s2">"Prediction"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
        var mathjaxscript = document.createElement('script');
        mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
        mathjaxscript.type = 'text/javascript';
        mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
        mathjaxscript[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" +
            "    config: ['MMLorHTML.js']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    displayAlign: 'center'," +
            "    displayIndent: '0em'," +
            "    showMathMenu: true," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true," +
            "        preview: 'TeX'," +
            "    }, " +
            "    'HTML-CSS': { " +
            " linebreaks: { automatic: true, width: '95% container' }, " +
            "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
    }
    </script>
</main>

<footer class="footer">
    <div class="container">
    <span class="text-muted">Copyright 2021 &copy;
      <a class="text-muted" href="https://iacs.seas.harvard.edu/">Institute for Applied Computational Science</a>
    </span>
    </div>
</footer>     <!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"
></script>
<script
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
        integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
        crossorigin="anonymous"
></script>
</body>
</html>